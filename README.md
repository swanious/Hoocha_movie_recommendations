# ì˜í™” ì¶”ì²œ í”„ë¡œì íŠ¸ HOOCHA ğŸğŸğŸ

![Medium Badge](https://img.shields.io/badge/Python-v3.7.8-blue)![Medium Badge](https://img.shields.io/badge/Django-v3.1.3-blue)![Medium Badge](https://img.shields.io/badge/djangorestframework-v3.12.2-blue)![Medium Badge](https://img.shields.io/badge/Javascript-v1.7-red)![Medium Badge](https://img.shields.io/badge/License-TMBD-bri)

## í”„ë¡œì íŠ¸ ê°œìš”

- TMDB open APIì˜ Top rated ë°ì´í„° í™œìš©

- OpenWeather API í™œìš© ë‚ ì”¨ë³„ ì˜í™” ì¥ë¥´ ë¶„ë¥˜

- í”„ë¡œì íŠ¸ ê¸°ê°„: 2020ë…„ 11ì›” 19ì¼ ~ 2020ë…„ 11ì›” 27ì¼

- í”„ë¡œì íŠ¸ íŒ€ì›: ì´ê°•ë¦¼, ì˜¤ìˆ˜ì™„

- 1000ê°œì˜ ì˜í™” ë°ì´í„° / 6ê°œì˜ ë‚ ì”¨ ë¶„ë¥˜



## í”„ë¡œì íŠ¸ í™”ë©´

### ë¡œê·¸ì¸ / íšŒì›ê°€ì… í™”ë©´

- íšŒì›ê°€ì… í›„ ë°”ë¡œ ë©”ì¸ í˜ì´ì§€ í™”ë©´ ì „í™˜

![image-20201130144722156](README.assets/image-20201130144722156.png)

![image-20201130144812260](README.assets/image-20201130144812260.png)

### ë©”ì¸ í™”ë©´ êµ¬ì„±

- ì¢Œì¸¡ ë„¤ì´ê²Œì´ì…˜ ë°”
  - í…Œë§ˆ ë³€ê²½ ê°€ëŠ¥
  - ì‚¬ìš©ì í”„ë¡œí•„ í˜ì´ì§€ / ë¡œê·¸ì•„ì›ƒ ë²„íŠ¼
- ë©”ì¸ í™”ë©´
  - OpenweatherAPIë¥¼ í™œìš©í•œ ë‚ ì”¨ë³„ ì˜í™” ì¶”ì²œ
  - ì¥ë¥´ë³„ ì˜í™” ì¶”ì²œ
  - ì˜í™” í´ë¦­ ì‹œ ë””í…Œì¼ í™”ë©´ ì°½ ë„ì›€(ë¦¬ë·° ì‘ì„± ë° í•œì¤„í‰ ë‚¨ê¸°ê¸°)

![image-20201130145131232](README.assets/image-20201130145131232.png)

![image-20201130144848736](README.assets/image-20201130144848736.png)

### ì˜í™” ìƒì„¸ ì •ë³´

- ì˜í™” ìƒì„¸ì •ë³´ í˜ì´ì§€

- ì¢Œì¸¡ ë„¤ë¹„ê²Œì´ì…˜ ë°”
  - ë¦¬ë·° ë° ëŒ“ê¸€ ì‘ì„±
  - í•œì¤„í‰ ì‘ì„±

![image-20201130145823857](README.assets/image-20201130145823857.png)

![image-20201130145839933](README.assets/image-20201130145839933.png)



### ë¦¬ë·° / ëŒ“ê¸€ ì‘ì„±

- ë¦¬ë·° ì‘ì„±
  - AJAX ìš”ì²­ìœ¼ë¡œ í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ ì—†ì´ ë¦¬ë·° ìƒì„± / ì¢‹ì•„ìš”, ì‹«ì–´ìš” ê¸°ëŠ¥ êµ¬í˜„
  - ì‘ì„±ìë§Œ ìˆ˜ì • ê°€ëŠ¥

![image-20201130145719931](README.assets/image-20201130145719931.png)

![image-20201130150004582](README.assets/image-20201130150004582.png)

![image-20201130150130642](README.assets/image-20201130150130642.png)

- ìƒì„¸ ë¦¬ë·° í˜ì´ì§€
  - ì‘ì„±ì ê¸€ ìˆ˜ì • ê¸°ëŠ¥
  - AJAX ìš”ì²­ìœ¼ë¡œ ëŒ“ê¸€ CUD ê¸°ëŠ¥ êµ¬í˜„

![image-20201130150212478](README.assets/image-20201130150212478.png)

![image-20201130150957270](README.assets/image-20201130150957270.png)

![image-20201130151009454](README.assets/image-20201130151009454.png)

- ìƒì„±

![image-20201130150650934](README.assets/image-20201130150650934.png)

![image-20201130150701013](README.assets/image-20201130150701013.png)

- ìˆ˜ì •

![image-20201130150748696](README.assets/image-20201130150748696.png)

![image-20201130150802623](README.assets/image-20201130150802623.png)



### í•œì¤„í‰

- í•œì¤„í‰ ì‘ì„± ê¸°ëŠ¥
  - AJAX ìš”ì²­ìœ¼ë¡œ ìƒˆë¡œê³ ì¹¨ ì—†ì´ CUD ë° ì¢‹ì•„ìš”/ì‹«ì–´ìš” ê¸°ëŠ¥
  - 0~10ì  í‰ì  ë‚¨ê¸°ê¸°
  - í‰ì  ë°ì´í„° ë°˜ì˜
    - í…ŒìŠ¤íŠ¸ë¥¼ ìœ„í•´ ì†Œìˆ«ìë¦¬ ì œê±° x

![image-20201130151408687](README.assets/image-20201130151408687.png)



- í‰ì  ë°˜ì˜

![image-20201130152742204](README.assets/image-20201130152742204.png)

![image-20201130151656608](README.assets/image-20201130151656608.png)

### í”„ë¡œí•„ í˜ì´ì§€

- íšŒì›ì •ë³´ ìˆ˜ì • ê¸°ëŠ¥(ë¹„ë°€ë²ˆí˜¸ ë³€ê²½, ì´ë¦„ ìˆ˜ì •)
- ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í´ë¦­ ì‹œ ë¹„ë°€ë²ˆí˜¸ ë³€ê²½ í˜ì´ì§€ë¡œ ì´ë™

- ë‚¨ê¸´ ë¦¬ë·° / ëŒ“ê¸€ í™•ì¸

![image-20201130153240541](README.assets/image-20201130153240541.png)



## í”„ë¡œì íŠ¸ ê¸°ëŠ¥

### ë°ì´í„° ë² ì´ìŠ¤ ëª¨ë¸ë§(ERD)

![image-20201130141402238](README.assets/image-20201130141402238.png)



### ë°ì´í„° ìˆ˜ì§‘ ë° ê°€ê³µ

> **TMDB**
>
> - Top Rated / Popular / Detail ë“± ë‹¤ì–‘í•œ ë¶„ë¥˜ë¡œ ì˜í™” ë°ì´í„°ë¥¼ ë°›ì•„ì˜¬ ìˆ˜ ìˆìŒ
> - ë¶ˆíŠ¹ì • ë‹¤ìˆ˜ì˜ ì˜í™” ë°ì´í„°ë¥¼ í•œ ë²ˆì— ê°€ì ¸ì˜¬ ìˆ˜ ìˆê³ , ë°ì´í„° ê°€ê³µì— ìœ ë¦¬í•˜ë‹¤ê³  íŒë‹¨í•˜ì—¬ ì±„íƒ

#### API í™œìš© ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸° ë° ê°€ê³µ

> ì˜í™” ë°ì´í„°(ì•½ 400ê°œ)
>
> ì¥ë¥´ ë°ì´í„°(TMBDì˜ idê°’ì„ ì´ìš©í•˜ì—¬ string íƒ€ì…ìœ¼ë¡œ ë³€í™˜í•˜ì—¬ ì¥ë¥´ ì €ì¥)
>
> ì˜í™”(M):ì¥ë¥´(N) ì¤‘ê³„ í…Œì´ë¸” ìƒì„±

#### ì˜í™” í…Œì´ë¸”

- ì•½ 400ê°œì˜ ë°ì´í„° ì €ì¥

![image-20201120010507488](README.assets/image-20201120010507488.png)

#### ì¥ë¥´ í…Œì´ë¸”

- 19ê°œì˜ ì¥ë¥´ ë°ì´í„° ì €ì¥

![image-20201120010549914](README.assets/image-20201120010549914.png)

#### M:N ì¤‘ê³„ í…Œì´ë¸” (ì˜í™” : ì¥ë¥´)

- í•˜ë‚˜ì˜ ì˜í™”ê°€ ë‹¤ìˆ˜ì˜ ì¥ë¥´ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŒ
- ì¥ë¥´ë³„ë¡œ ë‹¤ìˆ˜ì˜ ì˜í™”ê°€ ì¡´ì¬í•¨
- 1089ê°œì˜ ì¤‘ê³„ í…Œì´ë¸” ë°ì´í„° ì €ì¥

![image-20201120010645211](README.assets/image-20201120010645211.png)

#### ë°ì´í„° ìƒì„± ì½”ë“œ

```python
from django.shortcuts import render
import requests

from .models import Movie, Genre

def tmdb(request):
    API_URL = 'https://api.themoviedb.org/3/movie/top_rated'

    genres = [
        {
        "id": 28,
        "name": "ì•¡ì…˜"
        },
        {
        "id": 12,
        "name": "ëª¨í—˜"
        },
        {
        "id": 16,
        "name": "ì• ë‹ˆë©”ì´ì…˜"
        },
        {
        "id": 35,
        "name": "ì½”ë¯¸ë””"
        },
        {
        "id": 80,
        "name": "ë²”ì£„"
        },
        {
        "id": 99,
        "name": "ë‹¤íë©˜í„°ë¦¬"
        },
        {
        "id": 18,
        "name": "ë“œë¼ë§ˆ"
        },
        {
        "id": 10751,
        "name": "ê°€ì¡±"
        },
        {
        "id": 14,
        "name": "íŒíƒ€ì§€"
        },
        {
        "id": 36,
        "name": "ì—­ì‚¬"
        },
        {
        "id": 27,
        "name": "ê³µí¬"
        },
        {
        "id": 10402,
        "name": "ìŒì•…"
        },
        {
        "id": 9648,
        "name": "ë¯¸ìŠ¤í„°ë¦¬"
        },
        {
        "id": 10749,
        "name": "ë¡œë§¨ìŠ¤"
        },
        {
        "id": 878,
        "name": "SF"
        },
        {
        "id": 10770,
        "name": "TV ì˜í™”"
        },
        {
        "id": 53,
        "name": "ìŠ¤ë¦´ëŸ¬"
        },
        {
        "id": 10752,
        "name": "ì „ìŸ"
        },
        {
        "id": 37,
        "name": "ì„œë¶€"
        }
    ]
	
    # genre_id(ìˆ«ì) -> genre_name(string)ìœ¼ë¡œ ë³€í™˜
    id2genre = {
        genre['id']: genre['name'] for genre in genres
    }
    # Genre ìƒì„±
    for genre_name in id2genre.values():
        genre_instance = Genre()
        genre_instance.name = genre_name
        genre_instance.save()

    genres = Genre.objects.all()
    for genre in genres:
        print(genre.name)

    # TMDB APIë¥¼ í™œìš©í•˜ì—¬ 1 ~ 21 í˜ì´ì§€ì— í•´ë‹¹í•˜ëŠ” ì˜í™” ì •ë³´ ì¶”ì¶œ
    for page in range(1, 21):
        payload = {
            'api_key': '7571218b4ab42912852227b3b4ea629c',
            'language': 'ko-KR',
            'page': page,
            'region': 'KR',
        }
        response = requests.get(
            API_URL,
            params = payload,
        )
        # 20ê°œì˜ ì˜í™” ì •ë³´ ìƒì„±
        movie_list = response.json().get('results')
        
        # movie_list(20ê°œì˜ ì˜í™”ë“¤)ì˜ ì •ë³´ ì¤‘
        # movie(1ê°œì˜ ì˜í™” ì •ë³´)
        for movie in movie_list:
            # ì˜í™” ì •ë³´ ê°€ê³µ
            if movie.get('backdrop_path'):
                movie['backdrop_path'] = 'https://image.tmdb.org/t/p/w500' + movie['backdrop_path']
            movie['poster_path'] = 'https://image.tmdb.org/t/p/w500' + movie['poster_path']
            movie['genre_names'] = [
                id2genre[genre_id] for genre_id in movie['genre_ids']
            ]

            # Movie ìƒì„±
            movie_instance = Movie()

            movie_instance.id = movie['id']
            movie_instance.popularity = movie['popularity']
            movie_instance.video = movie['video']
            movie_instance.vote_count = movie['vote_count']
            movie_instance.vote_average = movie['vote_average']
            movie_instance.title = movie['title']
            movie_instance.release_date = movie['release_date']
            movie_instance.original_language = movie['original_language']
            movie_instance.original_title = movie['original_title']
            movie_instance.backdrop_path = movie['backdrop_path']
            movie_instance.adult = movie['adult']
            movie_instance.overview = movie['overview']
            movie_instance.poster_path =movie['poster_path']

            movie_instance.save()

            # ì¤‘ê³„ í…Œì´ë¸” ìƒì„± (M:N)
            for genre_id in movie['genre_ids']:
                if id2genre.get(genre_id):
                    genre_instance = Genre.objects.get(name=id2genre[genre_id])
                    genre_instance.movies.add(movie_instance)


    movies = Movie.objects.all()
    for movie in movies:
        print(movie.title)

    return render(request, 'data/index.html')
```



## dummy data

- ë„¤ì´ë²„ API

```python
from django.shortcuts import render
import requests

from .models import Movie, Genre


def naver(request):
    payload = {
        'query': 'ì¸í„°ìŠ¤í…”ë¼',
    }
    headers = {
        'X-Naver-Client-Id': '7ptwva7zZrZdP2xgQCb9',
        'X-Naver-Client-Secret': '6EHPskOKjd',
    }
    response = requests.get(
        'https://openapi.naver.com/v1/search/movie.json',
        params = payload,
        headers = headers,
    )
    response_dict = response.json()
    pprint(response_dict)
    context = {
        'items': response_dict.get('items'),
    }
    return render(request, 'data/index.html', context)
```

- ì˜í™” ì§„í¥ ìœ„ì›íšŒ

```python
from django.shortcuts import render
import requests

from .models import Movie, Genre

def kofic(request):
    API_URL = 'http://www.kobis.or.kr/kobisopenapi/webservice/rest/movie/searchMovieList.json'
    for i in range(1, 2):
        payload = {
            'key': 'a56b3a9ad2d444b6e20f9f1d8d00db28',
            'curPage': i,
            'itemPerPage': 100,
            'prdtStartYear': '2000',
            'prdtEndYear': '2020',
        }
        response = requests.get(
            API_URL,
            params = payload,
        )
        
        response_dict = response.json()
        pprint(response_dict)
        print(response.url)
    return render(request, 'data/index.html')
```

